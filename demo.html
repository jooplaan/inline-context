<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inline Context - Demo</title>
    <!-- Load compiled frontend styles (includes tooltip styles) -->
    <link rel="stylesheet" href="build/style-index.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 40px auto;
            padding: 0 20px;
            color: #333;
        }

        h1 {
            color: #2271b1;
            border-bottom: 2px solid #2271b1;
            padding-bottom: 10px;
        }

        .demo-controls {
            margin: 30px 0;
            padding: 20px;
            background: #fff3cd;
            border: 1px solid #ffecb5;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .demo-controls h2 {
            margin-top: 0;
            color: #856404;
        }

        .display-mode-toggle {
            display: flex;
            gap: 15px;
            align-items: center;
            margin-top: 15px;
        }

        .display-mode-toggle label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px 12px;
            background: white;
            border: 2px solid #2271b1;
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        .display-mode-toggle input[type="radio"] {
            cursor: pointer;
        }

        .display-mode-toggle label:hover {
            background: #f0f6fc;
        }

        .display-mode-toggle input[type="radio"]:checked + span {
            font-weight: 600;
        }

        .display-mode-toggle label:has(input:checked) {
            background: #2271b1;
            color: white;
        }

        .demo-section {
            margin: 40px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 6px;
        }

        .wp-inline-context {
            cursor: pointer;
            /* Appear as regular text by default - no underline or color change */
            text-decoration: none;
            color: inherit;
            /* Keep text and chevron on the same line */
            white-space: nowrap;
            /* Smooth color transition for hover/focus states */
            transition: color 0.2s ease;
        }

        /* Hover and focus states - change text color to primary */
        .wp-inline-context:hover,
        .wp-inline-context:focus {
            color: #2271b1;
        }

        .wp-inline-context:focus {
            outline: 2px solid #2271b1;
            outline-offset: 2px;
            border-radius: 2px;
        }

        .wp-inline-context::after {
            content: '';
            display: inline-block;
            width: 0.75em;
            height: 0.75em;
            margin-left: 0.25em;
            vertical-align: middle;
            text-decoration: none;
            /* Use a subtle gray color by default */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="%23666"><path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            transition: transform 0.4s ease, background-image 0.2s ease;
            opacity: 0.7;
        }

        /* Change chevron color on hover/focus to match primary color */
        .wp-inline-context:hover::after,
        .wp-inline-context:focus::after {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="%232271b1"><path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06z"/></svg>');
            opacity: 1;
        }

        .wp-inline-context[aria-expanded="true"]::after,
        .wp-inline-context.wp-inline-context--open::after {
            transform: rotate(180deg);
        }

        .wp-inline-context--open {
            font-weight: 600;
            color: #2271b1;
        }

        .wp-inline-context-inline {
            display: block;
            margin: 0.75em 0;
            padding: 0.75em 1em;
            background: rgba(0, 0, 0, 0.04);
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-left: 3px solid #2271b1;
            border-radius: 6px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
            font-size: 0.95em;
            animation: wp-inline-context-reveal 0.3s ease-out;
            transform-origin: top left;
        }

        @keyframes wp-inline-context-reveal {
            from {
                opacity: 0;
                transform: translateY(-8px);
                max-height: 0;
                overflow: hidden;
            }

            to {
                opacity: 1;
                transform: translateY(0);
                max-height: 500px;
            }
        }

        .wp-inline-context-inline> :first-child {
            margin-top: 0;
        }

        .wp-inline-context-inline> :last-child {
            margin-bottom: 0;
        }

        .wp-inline-context-inline a {
            color: inherit;
            text-decoration-color: currentColor;
        }

        code {
            background: #f0f0f0;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>

<body>
    <h1>Inline Context - Demo</h1>

    <div class="demo-controls">
        <h2>üéõÔ∏è Display Mode Selector</h2>
        <p>Try switching between the two display modes to see how inline context notes can be shown:</p>
        <div class="display-mode-toggle">
            <label>
                <input type="radio" name="displayMode" value="inline" checked>
                <span>üìÑ Inline Mode</span>
            </label>
            <label>
                <input type="radio" name="displayMode" value="tooltip">
                <span>üí¨ Tooltip Mode</span>
            </label>
        </div>
        <p style="margin-top: 15px; font-size: 0.9em; color: #856404;">
            <strong>Inline Mode:</strong> Notes expand directly below the trigger text in the content flow.<br>
            <strong>Tooltip Mode:</strong> Notes appear as floating tooltips above or below the trigger (v2.1+).
        </p>
    </div>

    <div class="demo-section">
        <h2>Example 1: Subtle Design (Hover to See)</h2>
        <p>
            This plugin helps you add <a href="#context-note-demo1" class="wp-inline-context"
                data-inline-context="<p>Notice how this anchor link appears as regular text with only a subtle chevron icon (‚Üì) indicating additional context is available.</p><p>When you hover or focus on the link, the text color changes to the primary color to show it's interactive, but otherwise it maintains optimal reading flow by not looking like a traditional underlined link.</p>"
                data-anchor-id="context-note-demo1" role="button" aria-expanded="false">inline context notes</a> to your
            content without breaking the reading flow. The anchor appears as normal text with only the icon showing
            there's more information.
        </p>
    </div>

    <div class="demo-section">
        <h2>Example 2: Rich Content with HTML</h2>
        <p>
            WordPress powers over <a href="#context-note-demo2" class="wp-inline-context"
                data-inline-context="<p>WordPress is used by <strong>43%</strong> of all websites on the internet, according to <em>W3Techs</em> data from 2023.</p>"
                data-anchor-id="context-note-demo2" role="button" aria-expanded="false">40% of the web</a>, making it
            the most popular content management system.
        </p>
    </div>

    <div class="demo-section">
        <h2>Example 3: Technical Definition</h2>
        <p>
            The block editor uses <a href="#context-note-demo3" class="wp-inline-context"
                data-inline-context="<p>React is a JavaScript library for building user interfaces. It allows developers to create reusable UI components and manage complex application state efficiently.</p><p>Learn more at <a href='https://react.dev' rel='noopener noreferrer'>react.dev</a>.</p>"
                data-anchor-id="context-note-demo3" role="button" aria-expanded="false">React</a> for its interface
            components.
        </p>
    </div>

    <div class="demo-section">
        <h2>Example 4: List Content</h2>
        <p>
            Modern web development requires knowledge of <a href="#context-note-demo4" class="wp-inline-context"
                data-inline-context="<p>The three core technologies are:</p><ul><li><strong>HTML</strong> - Structure</li><li><strong>CSS</strong> - Presentation</li><li><strong>JavaScript</strong> - Behavior</li></ul>"
                data-anchor-id="context-note-demo4" role="button" aria-expanded="false">several key technologies</a> to
            build interactive websites.
        </p>
    </div>

    <div class="demo-section">
        <h2>Example 5: Smart Link Behavior</h2>
        <p>
            This demonstrates <a href="#context-note-demo6" class="wp-inline-context"
                data-inline-context="<p>Smart link behavior in action:</p><ul><li><a href='/'>Internal link</a> (same tab)</li><li><a href='#top'>Anchor link</a> (same tab)</li><li><a href='https://wordpress.org'>External link</a> (new tab)</li><li><a href='?test=true'>Query link</a> (same tab)</li></ul><p>External links automatically get <code>target='_blank'</code> and security attributes!</p>"
                data-anchor-id="context-note-demo6" role="button" aria-expanded="false">smart link behavior</a> for
            internal vs external links.
        </p>
    </div>

    <div class="demo-section">
        <h2>Direct Links to Notes</h2>
        <p>
            You can now link directly to specific inline context notes using anchor URLs:
        </p>
        <ul>
            <li><a href="#context-note-demo1">Link to the first note about inline context</a></li>
            <li><a href="#context-note-demo2">Link to the WordPress statistics note</a></li>
            <li><a href="#context-note-demo3">Link to the React definition note</a></li>
            <li><a href="#context-note-demo4">Link to the web technologies note</a></li>
            <li><a href="#context-note-demo5">Link to the smart link behavior demo</a></li>
        </ul>
        <p>
            <em>Click any of these links to auto-open the corresponding note and scroll to it!</em>
        </p>
    </div>

    <div class="demo-section">
        <h2>Features</h2>
        <ul>
            <li>Click any highlighted text to reveal its inline context</li>
            <li>Click again to hide the context</li>
            <li>Multiple contexts can stay open at the same time</li>
            <li><strong>Two display modes:</strong> Inline (expands in content) or Tooltip (floating popup)</li>
            <li>Supports rich HTML formatting (bold, italic, links, lists)</li>
            <li>Accessible with proper ARIA attributes</li>
            <li>Keyboard-friendly: Tab to focus, then Enter or Space to toggle</li>
            <li>Theme-friendly CSS variables for easy customization</li>
            <li><strong>Direct linking:</strong> Share URLs with anchor links (#context-note-XXX)</li>
            <li><strong>Auto-open:</strong> Notes open automatically when page loads with matching hash</li>
            <li><strong>Smart links:</strong> Internal links stay in same tab, external links open in new tab</li>
            <li><strong>Smart positioning:</strong> Tooltips automatically flip to stay on screen</li>
        </ul>
    </div>

    <script>
        // Polyfill wp.hooks for demo.html (standalone usage without WordPress)
        window.wp = window.wp || {};
        window.wp.hooks = window.wp.hooks || {
            applyFilters: function (hookName, value) {
                // In demo mode, allow display mode switching
                if (hookName === 'inlineContext.displayMode') {
                    // Return the selected mode from radio buttons
                    const selected = document.querySelector('input[name="displayMode"]:checked');
                    return selected ? selected.value : value;
                }
                return value;
            }
        };

        // Mock the inline context data object
        window.inlineContextData = window.inlineContextData || {
            displayMode: 'inline' // Default mode
        };

        // Handle display mode changes
        document.addEventListener('DOMContentLoaded', function() {
            const radios = document.querySelectorAll('input[name="displayMode"]');
            
            radios.forEach(radio => {
                radio.addEventListener('change', function() {
                    // Update the global display mode
                    window.inlineContextData.displayMode = this.value;
                    
                    // Close all open notes when switching modes
                    const openTriggers = document.querySelectorAll('.wp-inline-context--open');
                    openTriggers.forEach(trigger => {
                        trigger.classList.remove('wp-inline-context--open');
                        trigger.setAttribute('aria-expanded', 'false');
                        
                        // Remove inline notes
                        const nextEl = trigger.nextElementSibling;
                        if (nextEl && nextEl.classList.contains('wp-inline-context-inline')) {
                            nextEl.remove();
                        }
                        
                        // Remove tooltips
                        const tooltipId = 'tooltip-' + trigger.getAttribute('data-anchor-id');
                        const tooltip = document.getElementById(tooltipId);
                        if (tooltip) {
                            tooltip.remove();
                        }
                    });
                    
                    console.log('Display mode changed to:', this.value);
                });
            });
        });
    </script>
    <script src="build/frontend.js"></script>
</body>

</html>
