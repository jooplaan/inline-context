// Frontend + editor shared styles for inline context

.wp-inline-context {
	cursor: pointer;
	/* Reset button styling to appear as regular text */
	background: none;
	border: none;
	padding: 0;
	margin: 0;
	font-family: inherit;
	font-size: inherit;
	font-weight: inherit;
	line-height: inherit;
	text-align: inherit;
	text-decoration: none;
	color: inherit;
	/* Allow text to wrap naturally */
	white-space: normal;
	overflow-wrap: anywhere;
	word-break: break-word;
	/* Smooth color transition for hover/focus states */
	transition: color 0.2s ease;
	/* Use inline to allow text wrapping, but keep icon with last word via ::after */
	display: inline;
	// Add scroll margin for smooth anchor navigation
	scroll-margin-top: var(
		--wp--custom--inline-context--link--scroll-margin,
		2rem
	);

	/* SVG chevron icon indicator - inline-block keeps it with last word */
	&::after {
		content: '';
		display: inline-block;
		width: var(--wp--custom--inline-context--chevron--size, 0.7em);
		height: var(--wp--custom--inline-context--chevron--size, 0.7em);
		margin-left: var(
			--wp--custom--inline-context--chevron--margin-left,
			0.25em
		);
		vertical-align: middle;
		text-decoration: none;
		background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="%23666"><path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06z"/></svg>');
		background-repeat: no-repeat;
		background-size: contain;
		background-position: center;
		transition: transform 0.4s ease, background-image 0.2s ease;
		opacity: var(--wp--custom--inline-context--chevron--opacity, 0.7);
	}

	&:hover::after,
	&:focus::after {
		background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="%232271b1"><path d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06z"/></svg>');
		opacity: var(--wp--custom--inline-context--chevron--hover-opacity, 1);
	}
}

/* Category icon styling */
.wp-inline-context-category-icon {
	display: inline-block;
	margin-left: 0.15em;
	margin-right: 0;
	font-size: 0.6em;
	vertical-align: super;
	line-height: 0;
	position: relative;
	top: -0.1em;
	transition: color 0.2s ease, transform 0.2s ease;
	text-decoration: none;
}

/* Hide default chevron when category icon is present */
.wp-inline-context:has(.wp-inline-context-category-icon)::after {
	display: none;
}

/* Subtle scale effect on hover */
.wp-inline-context:hover .wp-inline-context-category-icon,
.wp-inline-context:focus-visible .wp-inline-context-category-icon {
	transform: scale(1.15);
}

/* Rotate effect for categories with different open/closed icons */
.wp-inline-context.wp-inline-context--open .wp-inline-context-category-icon {
	transform: scale(1);
}

/* Hover and focus states - change text color to primary */
.wp-inline-context:hover,
.wp-inline-context:focus-visible {
	color: var(
		--wp--custom--inline-context--link--hover-color,
		var(--wp--preset--color--primary, #0073aa)
	);
}

.wp-inline-context-inline {
	display: block;
	/* Spacing */
	margin: var(--wp--custom--inline-context--note--margin-y, 8px) 0;
	padding: var(--wp--custom--inline-context--note--padding-y, 0.75em)
		var(--wp--custom--inline-context--note--padding-x, 1em);
	/* Surface */
	background: var(
		--wp--custom--inline-context--note--background,
		rgba(0, 0, 0, 0.04)
	);
	border: 1px solid
		var(
			--wp--custom--inline-context--note--border-color,
			rgba(0, 0, 0, 0.08)
		);
	border-left: var(--wp--custom--inline-context--note--accent-width, 3px)
		solid
		var(
			--wp--custom--inline-context--note--accent-color,
			var(--wp--preset--color--primary, #0073aa)
		);
	border-radius: var(--wp--custom--inline-context--note--radius, 6px);
	box-shadow: var(
		--wp--custom--inline-context--note--shadow,
		0 1px 2px rgba(0, 0, 0, 0.05)
	);
	/* Typography */
	font-size: var(--wp--custom--inline-context--note--font-size, 0.95em);
	/* Progressive enhancement: smooth reveal animation */
	animation: wp-inline-context-reveal 0.3s ease-out;
	transform-origin: top left;

	/* Remove default focus outline since we're providing custom focus styles */
	&:focus {
		outline: none;
	}

	/* Custom focus-visible styles for keyboard navigation */
	&:focus-visible {
		outline: 2px solid var(--wp--preset--color--primary, #0073aa);
		outline-offset: 2px;
	}

	@media (prefers-reduced-motion: reduce) {
		animation: none;
	}
}

/* Noscript / Print styles */
.wp-inline-context-noscript-notes {
	margin-top: 2em;
	padding-top: 1.5em;
	border-top: 2px solid #ccc;

	h2 {
		font-size: 1.5em;
		margin-bottom: 1em;
	}

	ol {
		padding-left: 20px;
	}

	li {
		margin-bottom: 1.5em;
		padding-left: 5px;
	}

	.wp-inline-context-back-link {
		display: inline-block;
		margin-left: 0.5em;
		text-decoration: none;
		font-size: 1.2em;
		line-height: 1;
	}
}

/* Hide endnotes section when JavaScript is available */
.js .wp-inline-context-noscript-notes {
	display: none;
}

@media print {
	.wp-inline-context-inline {
		display: block !important; /* Ensure notes are visible for printing */
		animation: none;
		box-shadow: none;
		border: 1px solid #ccc;
	}

	.wp-inline-context::after {
		display: none; /* Hide interactive chevron */
	}
}

.wp-inline-context-inline > :first-child {
	margin-top: 0;
}

.wp-inline-context-inline > :last-child {
	margin-bottom: 0;
}

.wp-inline-context-tooltip>*:first-of-type {
	margin-top: 0;
}
.wp-inline-context-tooltip > *:last-of-type {
	margin-bottom: 0;
}

/* Optional link styling inside notes (theme-overridable) */
.wp-inline-context-inline a {
	color: var(--wp--custom--inline-context--note--link-color, inherit);
	text-decoration-color: var(
		--wp--custom--inline-context--note--link-underline,
		currentColor
	);
}

.wp-inline-context--open {
	color: var(
		--wp--custom--inline-context--link--open-color,
		var(--wp--preset--color--primary, #0073aa)
	);
}

/* Rotate chevron up when expanded */
.wp-inline-context[aria-expanded='true']::after,
.wp-inline-context.wp-inline-context--open::after {
	transform: rotate(180deg);
}

/* ============================================
   Tooltip Mode Styles
   ============================================ */

.wp-inline-context-tooltip {
	position: absolute;
	z-index: 10000;
	max-width: 400px;
	min-width: 200px;
	/* Spacing - extra padding-right to avoid close button collision */
	padding: var(--wp--custom--inline-context--note--padding-y, 0.75em)
		2.5em /* Extra space for close button */
		var(--wp--custom--inline-context--note--padding-y, 0.75em)
		var(--wp--custom--inline-context--note--padding-x, 1em);
	/* Surface */
	background: var(
		--wp--custom--inline-context--note--background,
		#fff
	);
	border: 1px solid
		var(
			--wp--custom--inline-context--note--border-color,
			rgba(0, 0, 0, 0.15)
		);
	border-radius: var(--wp--custom--inline-context--note--radius, 6px);
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1);
	/* Typography */
	font-size: var(--wp--custom--inline-context--note--font-size, 0.95em);
	line-height: 1.5;
	color: #1d2327;
	/* Smooth reveal animation */
	animation: wp-inline-context-tooltip-reveal 0.2s ease-out;
	transform-origin: top center;
	/* Word wrapping */
	overflow-wrap: break-word;
	word-break: break-word;

	/* Remove default focus outline since we're providing custom focus styles */
	&:focus {
		outline: none;
	}

	/* Custom focus-visible styles for keyboard navigation */
	&:focus-visible {
		outline: 2px solid var(--wp--preset--color--primary, #0073aa);
		outline-offset: 2px;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1),
			0 0 0 2px var(--wp--preset--color--primary, #0073aa);
	}

	@media (prefers-reduced-motion: reduce) {
		animation: none;
	}

	/* Responsive max-width */
	@media (max-width: 768px) {
		max-width: calc(100vw - 40px);
	}
}

/* Tooltip arrow/pointer styles */
.wp-inline-context-tooltip--above::after {
	content: '';
	position: absolute;
	bottom: -8px;
	left: 50%;
	transform: translateX(-50%);
	width: 0;
	height: 0;
	border-left: 8px solid transparent;
	border-right: 8px solid transparent;
	border-top: 8px solid
		var(
			--wp--custom--inline-context--note--background,
			#fff
		);
	filter: drop-shadow(0 2px 1px rgba(0, 0, 0, 0.1));
}

.wp-inline-context-tooltip--below::after {
	content: '';
	position: absolute;
	top: -8px;
	left: 50%;
	transform: translateX(-50%);
	width: 0;
	height: 0;
	border-left: 8px solid transparent;
	border-right: 8px solid transparent;
	border-bottom: 8px solid
		var(
			--wp--custom--inline-context--note--background,
			#fff
		);
	filter: drop-shadow(0 -2px 1px rgba(0, 0, 0, 0.1));
}

/* Close button */
.wp-inline-context-tooltip-close {
	position: absolute;
	top: 0.5em;
	right: 0.5em;
	width: 24px;
	height: 24px;
	padding: 0;
	border: none;
	background: transparent;
	color: #757575;
	font-size: 24px;
	line-height: 1;
	cursor: pointer;
	transition: color 0.2s ease, background 0.2s ease;
	border-radius: 4px;
	display: flex;
	align-items: center;
	justify-content: center;

	&:hover,
	&:focus {
		color: #1d2327;
		background: rgba(0, 0, 0, 0.05);
		outline: none;
	}

	&:focus-visible {
		outline: 2px solid var(--wp--preset--color--primary, #0073aa);
		outline-offset: 2px;
	}
}

/* Content spacing inside tooltip */
.wp-inline-context-tooltip > :first-child {
	margin-top: 0;
}

.wp-inline-context-tooltip > :last-child:not(.wp-inline-context-tooltip-close) {
	margin-bottom: 0;
}

/* Links inside tooltips */
.wp-inline-context-tooltip a {
	color: var(--wp--custom--inline-context--note--link-color, #0073aa);
	text-decoration-color: var(
		--wp--custom--inline-context--note--link-underline,
		currentColor
	);
}

/* Animations */
@keyframes wp-inline-context-tooltip-reveal {
	from {
		opacity: 0;
		transform: scale(0.95) translateY(-4px);
	}
	to {
		opacity: 1;
		transform: scale(1) translateY(0);
	}
}

/* Hide tooltips in print */
@media print {
	.wp-inline-context-tooltip {
		display: none !important;
	}
}

/* Accessibility: Focus states for triggers in tooltip mode */
body:has(.wp-inline-context-tooltip) .wp-inline-context:focus-visible {
	outline: 2px solid var(--wp--preset--color--primary, #0073aa);
	outline-offset: 2px;
}
